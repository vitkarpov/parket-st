# Верстка интернет-магазина «Паркет СТ» на БЭМ

## Рабочая копия

```
npm install && bower install
```

## Сборка

Версия для прода

```
npm run build
```

Дев-сервер

```
npm start
```

Страницы отвечают по запросу `localhost:8080/dist/{page}.html`. Первый запрос обрабатывается долго — идет сборка, на последующие запросы блоки, которые не менялись кешируются, перебилдивается только то, что изменилось.

Список страниц в `pages.json`

## Декларация блоков

Все страницы собираются из одного и того же bemdecl-файла:

```
module.exports = [{ block: "root" }];
```

Это означает, что у всех страниц один и тот же итоговый набор зависимостей. Это удобно, потому что в результате сборки статики нужно получить всего два файла:

- `parket.min.css`
- `parket.min.js`

Которые браузер получил на первый запрос любой страницы, а дальше — закеширует.

## О структуре

Библиотеки:

- libs/bem-core
- libs/bem-components

Проектные блоки:

- common.blocks
- pages.blocks

В `common` находятся:

- доопределения библиотечных блоков: тема `parket` для bem-components
- предметнонезависимые блоки: ссылка, карта, ...
- общие для страниц блоки: шапка, футер, ...

В `pages` находятся:

- большие, специфичные блоки страниц из которых и строится конечный интерфейс

Конечная bemjson-декларация страницы формируется с помощью `bemtree` блоков уровня `pages`: каждый блок умеет построить себя по данным.

## Про данные

Это статичная верстка: бекенда нет. Поэтому исходные данные захардкожены в `bemtree` блоков.

Если html должен генерироваться в рантайме, то имеет смысл ввести еще один уровень абстракции для работы с данными — модели.

Примерная схема такая:

- каждый блок умеет построить себя по данным с помощью bemtree
- все данные, которые нужны всем страницам разбиты на модельки: товар, коллекция товаров, адрес и т.д.
- каждый блок может обратиться к различным моделям, чтобы получить необходимые для своей отрисовки данные
- модель не обязательно могут соответствовать http-api бекенда, но в большинстве случаев это так (иногда может быть, что по смыслу это одна модель, но из-за особенностей бекенде нужно сходить в две разные ручки — это нормально)
